var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=(t,n,i)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i,s=(e,t)=>{for(var n in t||(t={}))r.call(t,n)&&a(e,n,t[n]);if(i)for(var n of i(t))o.call(t,n)&&a(e,n,t[n]);return e},u=(e,i)=>t(e,n(i)),c=(e,t)=>{var n={};for(var a in e)r.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&i)for(var a of i(e))t.indexOf(a)<0&&o.call(e,a)&&(n[a]=e[a]);return n},l=(e,t,n)=>(a(e,"symbol"!=typeof t?t+"":t,n),n);import{l as d,w as g,o as m,a as f,b as h,c as p,r as A,d as v,e as C,f as x,g as w,h as b,i as R,j as S,v as E,u as T,k as L,m as B,t as P,n as y,p as M,F as I,q as D,s as F,x as _,y as O}from"./vendor.84e83234.js";var U,N;!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}(),(N=U||(U={})).Mouseover="mouseover",N.Mouseenter="mouseenter",N.Mouseout="mouseout",N.Mouseleave="mouseleave",N.Mouseup="mouseup",N.Mousemove="mousemove",N.MouseDown="mousedown",N.DblClick="dblclick",N.Click="click",N.ContextMenu="contextmenu",N.KeyDown="keydown",N.Keyup="keyup",N.Keypress="keypress",N.Scroll="scroll",N.Resize="resize",N.Wheel="wheel",N.UndoRedoStateChanged="undoRedoStateChanged";const W={scaleRatio:1,positionRange:{minX:0,maxX:0,minY:0,maxY:0}},X={horizontal:40,vertical:80},Y={horizontal:0,vertical:0},z={width:2e3,height:2e3},k=[.47,.42,.9,.5],G="rgba(119,106,230,1)",q="rgba(119,106,230,0)",V=2*Math.PI;function H(e){const{ctx:t,targetWidth:n,targetHeight:i,hiddenCtx:r,transformConfig:o,withBorder:a=!1}=e,{positionRange:s,scaleRatio:u}=o;t.canvas.width=n,t.canvas.height=i,t.imageSmoothingEnabled=false,J({ctx:t,hiddenCtx:r,positionRange:s,scaleRatio:u,withBorder:a,clearOld:!1})}function K(e={}){const{targetSize:t,cloneCanvas:n}=e,i=document.createElement("canvas"),r=i.getContext("2d");return t&&(i.width=t.width,i.height=t.height),n&&te.copyImageInCanvas(r,n),r}async function j(e){const t=new Image;return t.crossOrigin="anonymous",t.src=d.exports.isString(e)?e:URL.createObjectURL(e),await new Promise((e=>{t.onload=()=>e()})),createImageBitmap(t)}function Q(e){Z(e);const{hiddenCtx:t,imageSource:n,targetSize:{width:i,height:r}}=e;return function(e){const{ctx:t,imageSource:n,width:i,height:r}=e;return t.drawImage(n,0,0,i,r),createImageBitmap(t.canvas)}({ctx:t,imageSource:n,width:i,height:r})}function Z(e){const{targetSize:t,hiddenCtx:n,drawingCtx:i}=e,{width:r,height:o}=t;n.canvas.width=r,n.canvas.height=o,i.canvas.width=r,i.canvas.height=o}function J(e){const{ctx:t,positionRange:n,scaleRatio:i,hiddenCtx:r}=e,{clearOld:o=!0,withBorder:a}=e,{minX:s,minY:u}=n;o&&function(e){const{canvas:{width:t,height:n}}=e;e.clearRect(0,0,t,n)}(t),t.save(),t.translate(s,u),t.scale(i,i),t.drawImage(r.canvas,0,0),a&&function(e,t){const{width:n,height:i}=t.canvas;!function(e){const{ctx:t,lineStyle:n,lineWidth:i,positionRange:r}=e,{minY:o,maxX:a,maxY:s,minX:u}=r;t.imageSmoothingEnabled=!0,t.fillStyle=n,t.fillRect(u,o,a-u+i,i),t.fillRect(u,s,a-u+i,i),t.fillRect(u,o+i,i,s-o-i),t.fillRect(a,o+i,i,s-o-i),t.imageSmoothingEnabled=!1}({ctx:e,positionRange:{minX:0,minY:0,maxX:n,maxY:i},lineStyle:"#000000",lineWidth:1})}(t,r),t.restore()}function $(e){const{ctx:t,x:n,y:i,radius:r,hardness:o}=e,{innerColor:a=G,outerColor:s=q}=e;t.beginPath();const u=t.createRadialGradient(n,i,0,n,i,r);u.addColorStop(0,a),u.addColorStop(o,a),u.addColorStop(1,s),t.fillStyle=u,t.arc(n,i,r,0,V),t.fill()}function ee(e,t,n){(function(e,t){const n=function(e){const t=K({targetSize:e});return t.drawImage(e,0,0),t}(e);return function(e,t,n){e.globalCompositeOperation="destination-in",e.drawImage(t.canvas,0,0,n.width,n.height)}(n,t,e),n})(e,t).canvas.toBlob((e=>{if(!e)throw new Error("生成结果图像失败!");{const t=URL.createObjectURL(e);n(t)}}),"image/webp",.999)}const te={copyImageInCanvas:function(e,t){e.canvas.width=t.width,e.canvas.height=t.height,e.drawImage(t,0,0)}},{MouseDown:ne,Mouseup:ie,Mousemove:re}=U;class oe{constructor(){l(this,"unbindDownUpCache",new WeakMap),l(this,"unbindMoveCache",new WeakMap),l(this,"unbindWheelCache",new Set)}initMouseListeners(e){const{mouseTarget:t}=e;this.removeMouseListeners(t);const n=this.bindMouseListeners(e);this.unbindDownUpCache.set(t,n)}removeMouseListeners(e){const t=this.unbindDownUpCache.get(e);if(t){const{unbindDown:e,unbindUp:n}=t;e(),n()}}bindMouseListeners(e){const{mouseTarget:t,down:n,move:i,up:r}=e,o=e=>{requestAnimationFrame((()=>i(e)))};return{unbindDown:this.listenEvent({eventType:ne,listener:e=>{const i=e.target===t,r=n&&n(e);if(i&&!1!==r){const e=this.listenEvent({eventType:re,listener:o,stop:!0,prevent:!0});this.unbindMoveCache.set(t,e)}}}),unbindUp:this.listenEvent({eventType:ie,listener:e=>{r&&r(e),this.unbindMoveListeners(t)}})}}unbindMoveListeners(e){const t=this.unbindMoveCache.get(e);t&&t(),this.unbindMoveCache.delete(e)}initWheelListener(e){this.removeWheelListeners();const t=this.bindWheelListener(e);return this.unbindWheelCache.add(t),t}removeWheelListeners(){this.unbindWheelCache.forEach((e=>e())),this.unbindWheelCache.clear()}bindWheelListener(e){const{mattingBoards:t,wheel:n}=e;return this.listenEvent({eventType:U.Wheel,listener:e=>{this.canWheel(e,t)&&n(e)}},!1,...t)}canWheel(e,t){return t.some((t=>e.target===t))}listenEvent(e,t=!1,...n){const{eventType:i}=e,r=this.genWrapListener(e);let o;return o=this.isNeedToBindToTargets(n)?this.bindListeners(n,i,r,t):this.bindListener(window,i,r,t),o}genWrapListener(e){const{listener:t,stop:n,prevent:i}=e;return e=>{n&&e.stopPropagation(),i&&e.preventDefault(),t(e)}}isNeedToBindToTargets(e){return 0!==e.length}bindListener(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}bindListeners(e,t,n,i){return e.forEach((e=>{e.addEventListener(t,n,i)})),()=>e.forEach((e=>{e.removeEventListener(t,n,i)}))}}const{sign:ae,abs:se,max:ue}=Math;function ce(e){const{movementX:t,movementY:n}=e,i=se(t),r=se(n);return{unsignedMovementX:i,unsignedMovementY:r,maxMovement:ue(i,r)}}function le(e,t){return t>1&&e>t/2.5}function de(e,t){return-ae(e)*t}function ge(e,t,n,i){return e?t:n/i*t}function me(e,t,n){return e-t>n}const{sqrt:fe,max:he}=Math;function pe(e){return 0|e}const Ae=K();function ve(e){const{drawingConfig:t,maxMovement:n}=e,{step:i,stepBase:r,drawingCtx:o,radius:a,hardness:s}=t;let{x:u,y:c}=t;const{stepX:l,stepY:d}=function(e){const{drawingConfig:t,unsignedMovementX:n,unsignedMovementY:i,maxMovement:r}=e,{movementX:o,movementY:a,stepBase:s}=t,u=de(o,s),c=de(a,s),l=function(e,t){return e===t}(n,r);return{stepX:ge(l,u,n,i),stepY:ge(!l,c,i,n)}}(e);!function(e){const{width:t,height:n}=e.canvas;Ae.canvas.width=t,Ae.canvas.height=n,Ae.clearRect(0,0,t,n)}(o);for(let g=0,m=g;g<n;g+=r,u+=l,c+=d)me(g,m,i)&&(m=g,$({ctx:Ae,x:pe(u),y:pe(c),radius:a,hardness:s}));!function(e){const{isErasing:t,hiddenCtx:n,drawingCtx:i}=e;t?n.value.drawImage(Ae.canvas,0,0):xe(e,(()=>{i.drawImage(Ae.canvas,0,0)}))}(t)}function Ce(e){const{isErasing:t,hiddenCtx:n,drawingCtx:i}=e,{x:r,y:o,radius:a,hardness:s}=e;t?$({ctx:n.value,x:r,y:o,radius:a,hardness:s}):xe(e,(()=>{$({ctx:i,x:r,y:o,radius:a,hardness:s})}))}function xe(e,t){const{hiddenCtx:n,drawingCtx:i,mattingSource:r}=e;i.globalCompositeOperation="source-over",i.drawImage(r,0,0),i.globalCompositeOperation="destination-in",t(),n.value.drawImage(i.canvas,0,0)}function we(e){const{ctx:t,hiddenCtx:n,positionRange:i,scaleRatio:r,isErasing:o}=e;J({ctx:t.value,hiddenCtx:n.value,positionRange:i,scaleRatio:r,withBorder:be(o)})}function be(e){return void 0!==e}function Re(e){return function(e,t){const{width:n,height:i,left:r,top:o}=e,{left:a,top:s}=t;return{left:r-a,top:o-s,width:n,height:i}}(e.getBoundingClientRect(),document.documentElement.getBoundingClientRect())}function Se(e){let{width:t,height:n}=e;const i=Ee({imageSize:{width:t,height:n},gapSize:Y,targetSize:z});return t*=i,n*=i,{width:t,height:n}}function Ee(e){const{imageSize:t,gapSize:n,targetSize:i}=e,r=Te(i,n);return Math.min(Math.min(r.width/t.width,r.height/t.height),1)}function Te(e,t){return{width:e.width-2*t.horizontal,height:e.height-2*t.vertical}}function Le(e){const t=Ee(e);return{scaleRatio:t,positionRange:Be(e,t)}}function Be(e,t){const n=function(e,t){return{width:e.width*t,height:e.height*t}}(e.imageSize,t);return{minX:Pe(e,n),maxX:Me(e,n),minY:ye(e,n),maxY:Ie(e,n)}}function Pe(e,t){const{gapSize:n,targetSize:i}=e;return pe((Te(i,n).width-t.width)/2)+n.horizontal}function ye(e,t){const{gapSize:n,targetSize:i}=e;return pe((Te(i,n).height-t.height)/2)+n.vertical}function Me(e,t){return pe(Pe(e,t)+t.width)}function Ie(e,t){return pe(ye(e,t)+t.height)}const De={computeBoardRect:Re,computeTransformParameters:Le,computeScaleRatio:Ee,computeValidImageSize:Se,computePositionRange:Be,getPositionRangeMinX:Pe,getPositionRangeMaxX:Me,getPositionRangeMinY:ye,getPositionRangeMaxY:Ie},{sign:Fe}=Math;function _e(e,t){const{deltaY:n,pageX:i,pageY:r,target:o}=e,{positionRange:a,scaleRatio:s}=t,{left:u,top:c}=De.computeBoardRect(o),l=Oe.computePivot(i,u),d=Oe.computePivot(r,c),g=Oe.computeDeltaRatio(n),m=Oe.computeNewScaleRatio(s,g);t.scaleRatio=Oe.computeClampedTargetScaleRatio(m);const f=(t.scaleRatio-(h=s))/h;var h;t.positionRange=Oe.computeNewPositionRange(a,{x:l,y:d},f)}const Oe={updateTransformConfigWhileScaling:_e,computePivot:function(e,t){return e-t},computeDeltaRatio:function(e){return.04*(Oe.isZoomOut(e)?-1:1)},isZoomOut:function(e){return-1==-Fe(e)},computeNewScaleRatio:function(e,t){return e+e*t},computeClampedTargetScaleRatio:function(e){return e<.15?.15:e>10?10:e},computeNewPositionRange:function(e,t,n){const{x:i,y:r}=t;let{minX:o,maxX:a,minY:s,maxY:u}=e;return o=Oe.computeNewSingleRange(o,i,n),a=Oe.computeNewSingleRange(a,i,n),s=Oe.computeNewSingleRange(s,r,n),u=Oe.computeNewSingleRange(u,r,n),{minX:o,maxX:a,minY:s,maxY:u}},computeNewSingleRange:function(e,t,n){return e+(e-t)*n}};function Ue(e){const{listenerManager:t}=e,n=function(e){const t=e,{imageSources:n,imageSources:{raw:i,mask:r},initDrawingConfig:o,boardContexts:a}=t,u=c(t,["imageSources","imageSources","initDrawingConfig","boardContexts"]),{inputCtx:l,inputHiddenCtx:d,inputDrawingCtx:g,outputCtx:m,outputHiddenCtx:f,outputDrawingCtx:h}=a,p=function(e){const{radius:t,hardness:n,transformConfig:{scaleRatio:i,positionRange:r}}=e,o=function(e,t){return he(.5,e)/t}(t.value,i),a=function(e){return e/20}(o),s=function(e){return e/3.5}(o);return{radius:o,step:s,stepBase:a,scaleRatio:i,positionRange:r,hardness:n.value}}(o);return s({brushDrawingBaseConfig:p,mattingSources:n,inputBoardDrawingConfig:{ctx:l,hiddenCtx:d,drawingCtx:g,mattingSource:r},outputBoardDrawingConfig:{ctx:m,hiddenCtx:f,drawingCtx:h,mattingSource:i}},u)}(e),{inputBoardDrawingConfig:{ctx:i,hiddenCtx:r},outputBoardDrawingConfig:{hiddenCtx:o},brushDrawingBaseConfig:{positionRange:a}}=n,{boardRect:l,draggingInputBoard:d}=n;!function(e){const{inputBoardDrawingConfig:t,outputBoardDrawingConfig:n}=e,{mattingSources:{raw:i,mask:r},isErasing:o}=e;o?(t.mattingSource=i,n.hiddenCtx.value.globalCompositeOperation="destination-out"):(t.mattingSource=r,n.hiddenCtx.value.globalCompositeOperation="source-over")}(n);const g=function(e){const{brushDrawingBaseConfig:t,brushDrawingBaseConfig:{step:n,scaleRatio:i,positionRange:r},boardRect:{left:o,top:a}}=e,{inputBoardDrawingConfig:c,outputBoardDrawingConfig:l,isErasing:d}=e;let g=0;return e=>{const m=function(e){const{ev:t,scaleRatio:n,positionRange:i,left:r,top:o}=e,{minX:a,minY:u}=i,{movementX:c,movementY:l,pageX:d,pageY:g}=t,m=function(e){const{pageX:t,pageY:n,left:i,top:r,minX:o,minY:a,scaleRatio:s}=e;return{x:(t-i-o)/s,y:(n-r-a)/s}}({pageX:d,pageY:g,left:r,top:o,minX:a,minY:u,scaleRatio:n}),f=function(e,t){const{movementX:n,movementY:i}=e;return{movementX:n/t,movementY:i/t}}({movementX:c,movementY:l},n);return s(s({},m),f)}({ev:e,scaleRatio:i,positionRange:r,left:o,top:a}),{movementX:f,movementY:h}=m,p=s(s({},t),m);g+=fe(f**2+h**2),function(e,t,n){return e>=t||n===U.MouseDown}(g,n,e.type)&&(g=0,function(e){for(const t of e){const{radius:e}=t,{maxMovement:n,unsignedMovementX:i,unsignedMovementY:r}=ce(t);le(n,e)?ve({drawingConfig:t,unsignedMovementX:i,unsignedMovementY:r,maxMovement:n}):Ce(t),we(t)}}([s(s({},p),c),u(s(s({},p),l),{isErasing:d})]))}}(n);let m=!1;t.initMouseListeners({mouseTarget:i.value.canvas,down:e=>(m=function(e){const{ev:t,boardRect:n,positionRange:i,draggingInputBoard:r}=e,{pageX:o,pageY:a}=t,{left:s,top:u}=n,{minX:c,maxX:l,minY:d,maxY:g}=i,m=Oe.computePivot(o,s),f=Oe.computePivot(a,u);return function(e){const{x:t,y:n,minX:i,maxX:r,minY:o,maxY:a}=e;return t>=i&&t<=r&&n>=o&&n<=a}({x:m,y:f,minX:c,maxX:l,minY:d,maxY:g})&&!r}({ev:e,boardRect:l,positionRange:a,draggingInputBoard:d}),m&&g(e),m),move(e){!d&&m&&g(e)},up(e){!d&&m&&(m=!1,g(e))}})}function Ne(e){const{inputContexts:{ctx:t},outputContexts:{ctx:n},listenerManager:i}=e;return i.initWheelListener({mattingBoards:[t.canvas,n.canvas],wheel(t){!function(e,t){const{transformConfig:n,inputContexts:i,outputContexts:r}=t;_e(e,n)}(t,e)}})}const We=function(){const e={enable:{0:!0},disable:{0:!0},getParameter:{0:!0},drawArrays:{0:!0},drawElements:{0:!0,2:!0},createShader:{0:!0},getShaderParameter:{1:!0},getProgramParameter:{1:!0},getVertexAttrib:{1:!0},vertexAttribPointer:{2:!0},bindTexture:{0:!0},activeTexture:{0:!0},getTexParameter:{0:!0,1:!0},texParameterf:{0:!0,1:!0},texParameteri:{0:!0,1:!0,2:!0},texImage2D:{0:!0,2:!0,6:!0,7:!0},texSubImage2D:{0:!0,6:!0,7:!0},copyTexImage2D:{0:!0,2:!0},copyTexSubImage2D:{0:!0},generateMipmap:{0:!0},bindBuffer:{0:!0},bufferData:{0:!0,2:!0},bufferSubData:{0:!0},getBufferParameter:{0:!0,1:!0},pixelStorei:{0:!0,1:!0},readPixels:{4:!0,5:!0},bindRenderbuffer:{0:!0},bindFramebuffer:{0:!0},checkFramebufferStatus:{0:!0},framebufferRenderbuffer:{0:!0,1:!0,2:!0},framebufferTexture2D:{0:!0,1:!0,2:!0},getFramebufferAttachmentParameter:{0:!0,1:!0,2:!0},getRenderbufferParameter:{0:!0,1:!0},renderbufferStorage:{0:!0,1:!0},clear:{0:!0},depthFunc:{0:!0},blendFunc:{0:!0,1:!0},blendFuncSeparate:{0:!0,1:!0,2:!0,3:!0},blendEquation:{0:!0},blendEquationSeparate:{0:!0,1:!0},stencilFunc:{0:!0},stencilFuncSeparate:{0:!0,1:!0},stencilMaskSeparate:{0:!0},stencilOp:{0:!0,1:!0,2:!0},stencilOpSeparate:{0:!0,1:!0,2:!0,3:!0},cullFace:{0:!0},frontFace:{0:!0}};let t=null;function n(e){if(null==t){t={};for(const n in e)"number"==typeof e[n]&&(t[e[n]]=n)}}function i(){if(null==t)throw"WebGLDebugUtils.init(ctx) not called"}function r(e){i();const n=t&&t[e];return void 0!==n?n:"*UNKNOWN WebGL ENUM (0x"+e.toString(16)+")"}function o(t,n,i){const o=e[t];return void 0!==o&&o[n]?r(i):i.toString()}function a(e){const t=e.getParameter(e.MAX_VERTEX_ATTRIBS),n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n);for(let r=0;r<t;++r)e.disableVertexAttribArray(r),e.vertexAttribPointer(r,4,e.FLOAT,!1,0,0),e.vertexAttrib1f(r,0);e.deleteBuffer(n);const i=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);for(let r=0;r<i;++r)e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.bindTexture(e.TEXTURE_2D,null);for(e.activeTexture(e.TEXTURE0),e.useProgram(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.DITHER),e.disable(e.SCISSOR_TEST),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.clearDepth(1),e.clearStencil(-1),e.colorMask(!0,!0,!0,!0),e.cullFace(e.BACK),e.depthFunc(e.LESS),e.depthMask(!0),e.depthRange(0,1),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.UNPACK_COLORSPACE_CONVERSION_WEBGL&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.polygonOffset(0,0),e.sampleCoverage(1,!1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilMask(4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.viewport(0,0,e.canvas.clientWidth,e.canvas.clientHeight),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT);e.getError(););}return{init:n,mightBeEnum:function(e){return i(),!!t&&void 0!==t[e]},glEnumToString:r,glFunctionArgToString:o,makeDebugContext:function(e,t){n(e),t=t||function(e,t,n){let i="";for(let r=0;r<n.length;++r)i+=(0==r?"":", ")+o(t,r,n[r]);var a;a="WebGL error "+r(e)+" in "+t+"("+i+")",window.console&&window.console.log&&window.console.log(a)};const i={};function a(e,n){return function(){const r=e[n].apply(e,arguments),o=e.getError();return 0!=o&&(i[o]=!0,t(o,n,arguments)),r}}const s={};for(const n in e){const t=n;"function"==typeof e[t]?s[t]=a(e,t):s[t]=e[t]}return s.getError=function(){for(const e in i)if(i[e])return i[e]=!1,+e;return e.NO_ERROR},s},makeLostContextSimulatingContext:function(e){const t={};let n=1,i=!1;const r=[];let o,s,u;const c={};function l(e){for(let i=0;i<e.length;++i){const r=e[i];if((t=r)instanceof WebGLBuffer||t instanceof WebGLFramebuffer||t instanceof WebGLProgram||t instanceof WebGLRenderbuffer||t instanceof WebGLShader||t instanceof WebGLTexture)return r.__webglDebugContextLostId__==n}var t;return!0}function d(e,t){const n=e[t];return function(){if(!i){if(!l(arguments))return void(c[e.INVALID_OPERATION]=!0);return n.apply(e,arguments)}}}for(const a in e){const n=a;"function"==typeof e[a]?t[n]=d(e,n):t[n]=e[n]}function g(e){return{statusMessage:e}}t.loseContext=function(){if(!i){for(i=!0,++n;e.getError(););!function(){const e=Object.keys(c);for(let t=0;t<e.length;++t)delete c[e[t]]}(),c[e.CONTEXT_LOST_WEBGL]=!0,setTimeout((function(){o&&o(g("context lost"))}),0)}},t.restoreContext=function(){if(i){if(!s)throw"You can not restore the context without a listener";setTimeout((function(){if(function(){for(let t=0;t<r.length;++t){const n=r[t];n instanceof WebGLBuffer?e.deleteBuffer(n):n instanceof WebGLFramebuffer?e.deleteFramebuffer(n):n instanceof WebGLProgram?e.deleteProgram(n):n instanceof WebGLRenderbuffer?e.deleteRenderbuffer(n):n instanceof WebGLShader?e.deleteShader(n):n instanceof WebGLTexture&&e.deleteTexture(n)}}(),a(e),i=!1,s){const e=s;s=u,u=void 0,e(g("context restored"))}}),0)}},t.getError=function(){if(!i){let t;for(;t=e.getError();)c[t]=!0}for(const e in c)if(c[e])return delete c[e],+e;return e.NO_ERROR};const m=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"];for(let a=0;a<m.length;++a){const o=m[a];t[o]=function(t){return function(){if(i)return null;const o=t.apply(e,arguments);return o.__webglDebugContextLostId__=n,r.push(o),o}}(e[o])}const f=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];for(let a=0;a<f.length;++a){const n=f[a];t[n]=function(t){return function(){return i?null:t.apply(e,arguments)}}(t[n])}const h=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];for(let a=0;a<h.length;++a){const n=h[a];t[n]=function(t){return function(){return!i&&t.apply(e,arguments)}}(t[n])}var p;function A(e){return"function"==typeof e?e:function(t){e.handleEvent(t)}}return t.checkFramebufferStatus=(p=t.checkFramebufferStatus,function(){return i?e.FRAMEBUFFER_UNSUPPORTED:p.apply(e,arguments)}),t.getAttribLocation=function(t){return function(){return i?-1:t.apply(e,arguments)}}(t.getAttribLocation),t.getVertexAttribOffset=function(t){return function(){return i?0:t.apply(e,arguments)}}(t.getVertexAttribOffset),t.isContextLost=function(){return i},t.registerOnContextLostListener=function(e){o=A(e)},t.registerOnContextRestoredListener=function(e){i?u=A(e):s=A(e)},t},resetToInitialState:a}}(),Xe=function(){const e=function(e,t){const n=["webgl","experimental-webgl","webkit-3d","moz-webgl"];let i=null;for(let o=0;o<n.length;++o){try{i=e.getContext(n[o],t)}catch(r){}if(i)break}return i};return{create3DContext:e,setupWebGL:function(t,n,i){function r(e){const t=document.getElementsByTagName("body")[0];if(t){let n=window.WebGLRenderingContext?'It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org">Click here for more information.</a>':'This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>';e&&(n+="<br/><br/>Status: "+e),t.innerHTML=function(e){return'<div style="margin: auto; width:500px;z-index:10000;margin-top:20em;text-align:center;">'+e+"</div>"}(n)}}i=i||r,t.addEventListener&&t.addEventListener("webglcontextcreationerror",(e=>{(i=i||r)(e.statusMessage)}),!1);const o=e(t,n);return o||(window.WebGLRenderingContext,i("")),o}}}();function Ye(e,t,n){const i=function(e,t,n){const i=ze(e,e.VERTEX_SHADER,t),r=ze(e,e.FRAGMENT_SHADER,n);if(!i||!r)return null;const o=e.createProgram();if(!o)return null;e.attachShader(o,i),e.attachShader(o,r),e.linkProgram(o);if(!e.getProgramParameter(o,e.LINK_STATUS)){const t=e.getProgramInfoLog(o);return console.error("Failed to link program: "+t),e.deleteProgram(o),e.deleteShader(r),e.deleteShader(i),null}return o}(e,t,n);return i?(e.useProgram(i),e.program=i,!0):(console.error("Failed to create program"),!1)}function ze(e,t,n){const i=e.createShader(t);if(null==i)return console.error("unable to create shader"),null;e.shaderSource(i,n),e.compileShader(i);if(!e.getShaderParameter(i,e.COMPILE_STATUS)){const t=e.getShaderInfoLog(i);return console.error("Failed to compile shader: "+t,n),e.deleteShader(i),null}return i}window.requestAnimationFrame||(window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.clearTimeout);function ke(e,t=k){const n=function(e,t){let n=Xe.setupWebGL(e);return n?((arguments.length<2||t)&&(n=We.makeDebugContext(n)),n):null}(e);return n?Ye(n,"\nattribute vec4 a_Position;\nattribute vec2 a_TexCoord;\nvarying vec2 v_TexCoord;\nvoid main() {\n    gl_Position = a_Position;\n    v_TexCoord = a_TexCoord;\n}\n","\nprecision highp float;\nuniform sampler2D u_Sampler;\nuniform vec4 u_MaskColor;\nvarying vec2 v_TexCoord;\nvoid main() {\n    vec4 color = texture2D(u_Sampler, v_TexCoord);\n\t\tvec3 mixRGB = color.a > 0.0 ? mix(color.rgb, u_MaskColor.rgb, u_MaskColor.a) : color.rgb;\n    gl_FragColor = vec4(mixRGB, color.a);\n}\n")?function(e){const t=e.getAttribLocation(e.program,"a_Position"),n=e.getAttribLocation(e.program,"a_TexCoord");if(!~t||!~n)return console.error("获取attribute变量存储位置失败!"),!1;const i=e.createBuffer(),r=e.createBuffer();if(!i||!r)return console.error("创建缓冲区对象失败!"),!1;return Ge(e,i,t,new Float32Array([-1,1,1,1,-1,-1,1,-1])),Ge(e,r,n,new Float32Array([0,0,1,0,0,1,1,1])),!0}(n)?(function(e,t,n){const i=e.getUniformLocation(e.program,t);if(!i)return console.error("获取attribute变量存储位置失败!");Array.isArray(n)?e.uniform4fv(i,n):e.uniform1i(i,n)}(n,"u_MaskColor",t),e=>{if(console.time("draw mask image"),!function(e,t){const n=e.createTexture();if(!n)return console.error("创建纹理对象失败!"),!1;const i=e.getUniformLocation(e.program,"u_Sampler");if(!i)return console.error("获取取样器变量存储位置失败!"),!1;return e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.uniform1i(i,0),!0}(n,e))return console.error("纹理初始化失败!");n.drawArrays(n.TRIANGLE_STRIP,0,4),console.timeEnd("draw mask image")}):console.error("缓冲区初始化失败!"):console.error("着色器初始化失败!"):console.error("获取WebGL绘制上下文失败!")}function Ge(e,t,n,i,r=2){e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW),e.vertexAttribPointer(n,r,e.FLOAT,!1,0,0),e.enableVertexAttribArray(n)}async function qe(e){const{boardContexts:{inputCtx:t,outputCtx:n,inputHiddenCtx:i,inputDrawingCtx:r,outputHiddenCtx:o,outputDrawingCtx:a},picFile:s,transformConfig:u,targetSize:l,gapSize:d}=e;t.value.imageSmoothingEnabled=false,n.value.imageSmoothingEnabled=false;const g=await j(s),{scaleRatio:m,positionRange:f}=function(e){const t=e,{transformConfig:n}=t,i=c(t,["transformConfig"]);if(function(e){const{scaleRatio:t,positionRange:n}=e;return!t||!n}(n)){const{scaleRatio:e,positionRange:t}=function(e){const{imageSource:t,targetSize:n,gapSize:i=X}=e,r=Se(t);return Le({gapSize:i,imageSize:r,targetSize:n})}(i);n.scaleRatio=e,n.positionRange=t}return n}({imageSource:g,transformConfig:u,targetSize:l,gapSize:d}),h=Se(g);Q({imageSource:g,targetSize:h,hiddenCtx:i.value,drawingCtx:r}),J({hiddenCtx:i.value,ctx:t.value,scaleRatio:m,positionRange:f}),Z({targetSize:h,hiddenCtx:o.value,drawingCtx:a});return{orig:g,raw:await createImageBitmap(i.value.canvas),mask:await function(e){const{targetSize:{width:t,height:n},imageSource:i}=e,r=document.createElement("canvas");r.width=t,r.height=n;const o=ke(r);o&&o(i);return createImageBitmap(r)}({targetSize:h,imageSource:g}),positionRange:f,scaleRatio:m}}const Ve=K(),He=K();function Ke(e){const t=A(0),n=A(0),i=A(null),r=A(null),o=A(null),a=A(!1),c=A(!1),l=C(W),v=A(null),x=A(null),w=A(!1),b=A(K()),R=A(K()),S=new oe,E={boardContexts:{inputCtx:i,outputCtx:r,inputDrawingCtx:Ve,outputDrawingCtx:He,inputHiddenCtx:b,outputHiddenCtx:R},initMattingResult:o,transformConfig:l,mattingSources:v,initialized:w,boardRect:x},T=u(s({},E),{draggingInputBoard:a,isDrawing:c,listenerManager:S});return function(e,t){const{picFile:n}=e,{boardContexts:i,boardContexts:{inputCtx:r,outputCtx:o,inputHiddenCtx:a,outputHiddenCtx:u}}=t,{initMattingResult:c,width:l,height:g,initialized:m}=t,{boardRect:A,transformConfig:v,mattingSources:C}=t,x=()=>{A.value=Re(r.value.canvas)},w=()=>{requestAnimationFrame((()=>{const e={targetHeight:g.value,targetWidth:l.value,transformConfig:v};H(s({ctx:r.value,hiddenCtx:a.value},e)),H(s({ctx:o.value,hiddenCtx:u.value,withBorder:!0},e))}))};f([n],(async()=>{if(n.value&&l.value&&g.value){m.value=!1,c.value=await qe({boardContexts:i,picFile:n.value,targetSize:{width:l.value,height:g.value},transformConfig:{},imageSources:{}});const{raw:e,mask:t,orig:r,positionRange:o,scaleRatio:a}=c.value;v.positionRange=o,v.scaleRatio=a,C.value={raw:e,mask:t,orig:r},x(),w(),m.value=!0}})),h((()=>{window.addEventListener(U.Resize,w),window.addEventListener("scroll",d.exports.debounce(x,100))})),p((()=>{window.removeEventListener(U.Resize,w)}))}(e,u(s({},E),{width:t,height:n})),function(e,t){const{radius:n,hardness:i,isErasing:r}=e,{boardContexts:o,transformConfig:a,mattingSources:s,draggingInputBoard:u,initialized:c,boardRect:l,listenerManager:d}=t,{inputCtx:f}=o;g((()=>{c.value&&Ue({listenerManager:d,imageSources:s.value,boardContexts:o,initDrawingConfig:{radius:n,hardness:i,transformConfig:a},isErasing:r.value,draggingInputBoard:u.value,boardRect:l.value})})),m((()=>{d.removeMouseListeners(f.value.canvas)}))}(e,T),function(e){const{boardContexts:t,initialized:n,draggingInputBoard:i,transformConfig:r,isDrawing:o,listenerManager:a}=e,{inputCtx:u,inputHiddenCtx:c,outputCtx:l,outputHiddenCtx:d}=t;f([n,i,o],(()=>{if(n.value&&!o.value){const e={inputContexts:{ctx:u.value,hiddenCtx:c.value},outputContexts:{ctx:l.value,hiddenCtx:d.value},draggingInputBoard:i.value,listenerManager:a,transformConfig:r};!function(e){const{outputContexts:{ctx:t},transformConfig:n,listenerManager:i}=e;i.initMouseListeners({mouseTarget:t.canvas,move(e){const{positionRange:t}=n;!function(e,t){const{movementX:n,movementY:i}=e;t.minX+=n,t.maxX+=n,t.minY+=i,t.maxY+=i}(e,t)}})}(e),Ne(e),i.value||(r.positionRange=s({},r.positionRange))}}),{deep:!0}),f([r],(async()=>{if(n.value){const{positionRange:e,scaleRatio:t}=r,n={positionRange:e,scaleRatio:t};J(s({ctx:u.value,hiddenCtx:c.value},n)),J(s({ctx:l.value,hiddenCtx:d.value,withBorder:!0},n))}})),m((()=>{n.value&&(a.removeMouseListeners(l.value.canvas),a.removeWheelListeners())}))}(T),{width:t,height:n,inputCtx:i,outputCtx:r,inputHiddenCtx:b,outputHiddenCtx:R,draggingInputBoard:a,transformConfig:l,initialized:w,mattingSources:v}}class je{constructor(e,t){l(this,"ctx"),l(this,"cursorImage",A("")),l(this,"inputCursorStyle",A(null)),l(this,"mattingCursorStyle",C(Object.create(null))),l(this,"radius",A(12.5)),l(this,"hardness",A(.5)),l(this,"inputCanvas",v((()=>this.inputCtx.value.canvas))),l(this,"pointInnerColor",v((()=>this.isErasing.value?"rgba(255,255,255,1)":G))),l(this,"pointOuterColor",v((()=>this.isErasing.value?"rgba(255,255,255,0)":q))),this.inputCtx=e,this.isErasing=t,this.ctx=this.creatCursorCanvas()}creatCursorCanvas(){const e=document.createElement("canvas").getContext("2d");return this.updateCtx(e)}updateCtx(e){return e.canvas.width=2*this.radius.value,e.canvas.height=2*this.radius.value,e}async createCursorImage(){this.ctx=this.updateCtx(this.ctx);return $({ctx:this.ctx,x:this.radius.value,y:this.radius.value,radius:this.radius.value,hardness:this.hardness.value,innerColor:this.pointInnerColor.value,outerColor:this.pointOuterColor.value}),await this.drawIcon(),await this.ctx.canvas.toDataURL()}async drawIcon(){if(this.isErasing.value){const e=await j("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAqFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAs30iGAAAAN3RSTlMAuWM77dq/k2lBMiPo0K6po0kdF8e0jXteCfvz49XLmYRZVBIDw552cm4p996If04rRjZQDu8uOlnnbwAABJZJREFUeNrt3Ily2jAQBuA15jJgDmMg3DeEq5zNvv+btZ1OJ1VbEtvS2qvOfm/giSOt/x8JhBBCCCGEEEIIIYQQQggh+Mt1sJED6+0d/MG5gN2qPv5UqIDNggn+cryBvdohvhu5YKvlGn9X88BODwdVX1tgo76DfxqewT6rDv5tsADr1PGf5mCZBj7xAlZp4lNWjSsb/EAZrDHFD+3AEiX8xBas0MVP9cACJ4zgC7A3w0hmwNwXjKgLrPUwshIw9or4XzzJDmPZAFNljKkJLOUwtgYw9IIJ1FfAzRwT6fSBlwUm5CyBk/sAkyq2gY/WAZNbB8DFdYg6wirw4OVRj8/jSdwa6hpzCOtvI9TAJ6yvHFEDn7D+UkANfML6/Rg18Anrqz5q4BPWByFq4BPWt9eogU9YvyyiBj5h/cNBDXzC+n4HNfAJ61d11MAorG+gBkZhfRMJvUJqNqiBUVg/RQ2MwvoSkmvB32x8DlwDvS6mIA8aNAopCx/kWZFj26vVwycs+2ff4lNWLb9KITXGBHg0pTslwNn7GBOXnrSshB4VqIYYGaduMadEHi4ABEUkMAVaL0rg4cEPbQcj4NWQKoXU4Qo/LTv4CW79qFpIneGXfh0/wK8dPSuF1ALerRr4BMdutDVUgo4IH4s8m1HvqxJzkH1mOQ8gpRY5ZbIPlOISSLkjJRgg+0RZt4GUWuT0yD5SJgGQeitEmkpnyLwPVYucEzzV492GVv3IU+mWcxcaTGJMpTtMbHQDUu0w1jRXxoRqLpBqF2NOczlMJO8BqaUTe5qbYwLDFpBSTxbVIZLFAeM6nIGUerLI6UM05yG3/rOuTEEPiOqa59V+NhJPQV6NU/fZ1JiC3COf5nOjNQVVClx6z6kyPVwgrsuYR1eofCcdKxBfdYIRbIFW18D0EITZN54nI9NDu5h1UD0zND0sHfzQCUiphdTgTPZblS7QUr/zFmS/VikBrVezu24zq8B9Z3rX3WQTuJfN77rTLAL3HMWuW0o/cH+h2XVPaQfuc6p6eJZu4L4g23V7qR5Eug+odqvXVI8htQ5Uu9VO4xCS7smiKdlKOKkCKS9PtVupK6G/B1JujWq3mquB+xuQuo2oVvnzIM3AvXKkWuVbwzQP7FwKVKu8l0/1uI5DtcqrFWr+CqTU5TEMqN7YYQuINYjqSLV6PNyBGr4b78GYqq8RuGv/RQpvYEgQpn5IJ0ex0i+LGRzRccwfM304WRzQ2Y9N71qrejbHc/a+4aK4kdXhnKpvtCpuZncjWDAxuAdPs7wPrD0xtguXsr1Dqx8aKr67moG7vtDIRDFjcBPY2sBM0WNxe1ZRu8bfJgzcuT3Jjs0dYEWtSa/M6AYwR531NIKfxgoylXzam6uBe+Z3ZnUSPsldDdwfkLlkk2vrwO/mr2aC2dX7yvHer2ns6dWt8bz1qxtzfq2MlMCdx01Z/5iYvsSKKv09MLLFzOTDLRiUwww5YNAd9fC54eWK2ZmASR7q4HS5gIsRcX8QcAcYEetX67tbDRPhdwlSpYBZAPPexpiyfHgCIYQQQgghhBBCCCGEEEIIE74BPoWbxHyLr50AAAAASUVORK5CYII=");this.ctx.drawImage(e,0,0,2*this.radius.value,2*this.radius.value)}}renderOutputCursor(){const e=this.inputCanvas.value;e.addEventListener(U.Mouseover,this.onShowCursor.bind(this)),e.addEventListener(U.Mousemove,this.onRenderOutputCursor.bind(this)),e.addEventListener(U.Mouseout,this.onHideCursor.bind(this))}onShowCursor(){this.mattingCursorStyle.display="initial"}onHideCursor(){this.mattingCursorStyle.display="none"}onRenderOutputCursor(e){this.mattingCursorStyle.left=e.offsetX-this.radius.value+"px",this.mattingCursorStyle.top=e.offsetY-this.radius.value+"px"}changeOutputCursorByDrag([e]){e?this.onHideCursor():this.onShowCursor()}updateCursorParams(e,t){this.hardness.value=e,this.radius.value=t}}var Qe=(e,t)=>{for(const[n,i]of t)e[n]=i;return e};const Ze=e=>(D("data-v-e088369c"),e=e(),F(),e),Je={class:"options-container"},$e={class:"option"},et=Ze((()=>R("label",{for:"image"},"选择图片：",-1))),tt={class:"option"},nt=Ze((()=>R("span",null,"画笔类型：",-1))),it=Ze((()=>R("label",{for:"fix"},"修补",-1))),rt=Ze((()=>R("label",{for:"matting"},"擦除",-1))),ot={class:"option"},at=Ze((()=>R("label",{for:"radius"},"画笔尺寸：",-1))),st=["max","min","step"],ut={class:"option"},ct=Ze((()=>R("label",{for:"hardness"},"画笔硬度：",-1))),lt=["max","min","step"],dt=["disabled"],gt={class:"board-container"},mt={class:"matting-wrapper"},ft=["src"],ht={class:"matting-wrapper"},pt=["src"],At=["href","download"];var vt=Qe(x({setup(e){const t=A(null),n=A(null),i=A(""),r=A(null),o=A(!1),{picFile:a,isErasing:s,radius:u,hardness:c,brushSize:l,hardnessText:d}=function(){const e=A(null),t=A(!1),n=A(12.5),i=A(.5),r=v((()=>4*n.value)),o=v((()=>`${Math.round(100*i.value)}%`));return{picFile:e,isErasing:t,radius:n,hardness:i,brushSize:r,hardnessText:o}}(),{width:m,height:p,inputCtx:C,outputCtx:x,outputHiddenCtx:D,draggingInputBoard:F,initialized:_,mattingSources:O}=Ke({picFile:a,isErasing:s,radius:u,hardness:c}),{cursorImage:U,mattingCursorStyle:N,renderOutputCursor:W}=function(e){const{inputCtx:t,isDragging:n,isErasing:i,hardness:r,radius:o}=e,a=new je(t,i),{cursorImage:s,mattingCursorStyle:u,renderOutputCursor:c}=a;return g((async()=>{a.updateCursorParams(r.value,o.value),s.value=await a.createCursorImage()})),f([n],a.changeOutputCursorByDrag.bind(a)),{mattingCursor:a,mattingCursorStyle:u,cursorImage:s,renderOutputCursor:c.bind(a)}}({inputCtx:C,isDragging:F,isErasing:s,radius:u,hardness:c}),X=e=>{const{files:t}=e.target;t&&t[0]&&/.+\.(jpg|png|gif|webp)/.test(t[0].name)?a.value=t[0]:alert("未选择图片或图片格式不正确(只支持jpg、png、gif、webp), 请重新选择")},Y=v((()=>a.value?`matting_${a.value.name}`:"null")),z=v((()=>o.value||!_.value)),k=v((()=>({"save-btn":!0,disabled:z.value}))),G=v((()=>o.value?"保存中...":"保存"));function q(){O.value&&!o.value&&(o.value=!0,ee(O.value.orig,D.value,(e=>{o.value=!1,i.value=e,setTimeout((()=>{var e;null==(e=r.value)||e.click()}))})))}return h((()=>{!function(){const e=t.value,i=n.value;C.value=e.getContext("2d"),x.value=i.getContext("2d");const{clientWidth:r,clientHeight:o}=e;m.value=r,p.value=o}(),W()})),(e,o)=>(w(),b(I,null,[R("div",Je,[R("div",$e,[et,R("input",{id:"image",type:"file",accept:".jpg,.png,.gif,.webp",onChange:X},null,32)]),R("div",tt,[nt,it,S(R("input",{id:"fix",type:"radio",value:!1,"onUpdate:modelValue":o[0]||(o[0]=e=>L(s)?s.value=e:null)},null,512),[[E,T(s)]]),rt,S(R("input",{id:"matting",value:!0,type:"radio","onUpdate:modelValue":o[1]||(o[1]=e=>L(s)?s.value=e:null)},null,512),[[E,T(s)]])]),R("div",ot,[at,S(R("input",{id:"radius",class:"range-input",type:"range","onUpdate:modelValue":o[2]||(o[2]=e=>L(u)?u.value=e:null),max:T(25),min:T(.25),step:T(.25)},null,8,st),[[B,T(u)]]),R("span",null,P(T(l)),1)]),R("div",ut,[ct,S(R("input",{id:"hardness",class:"range-input",type:"range","onUpdate:modelValue":o[3]||(o[3]=e=>L(c)?c.value=e:null),max:T(1),min:T(0),step:T(.01)},null,8,lt),[[B,T(c)]]),R("span",null,P(T(d)),1)]),R("button",{class:y(T(k)),onClick:q,disabled:T(z)},P(T(G)),11,dt)]),R("div",gt,[R("div",mt,[R("canvas",{class:"matting-board",ref:(e,n)=>{n.inputCvs=e,t.value=e}},null,512),R("img",{class:"matting-cursor",style:M(T(N)),src:T(U),ref:(e,t)=>{t.inputCursor=e}},null,12,ft)]),R("div",ht,[R("canvas",{class:"result-board",ref:(e,t)=>{t.outputCvs=e,n.value=e}},null,512),R("img",{class:"matting-cursor",style:M(T(N)),src:T(U)},null,12,pt)])]),R("a",{href:i.value,download:T(Y),ref:(e,t)=>{t.resultLink=e,r.value=e}},null,8,At)],64))}}),[["__scopeId","data-v-e088369c"]]);O(x({setup:e=>(e,t)=>(w(),_(vt))})).mount("#app");
